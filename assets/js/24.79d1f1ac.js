(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{377:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"用户权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户权限"}},[t._v("#")]),t._v(" 用户权限")]),t._v(" "),a("p",[t._v("Vue Admin Next 的用户信息及应用权限通过全局状态 "),a("code",[t._v("src/common/store/state.js")]),t._v(" 进行管理。初始化时，首先会尝试从服务器端渲染的 "),a("code",[t._v("__INITIAL_STATE__")]),t._v(" 中获取，若没有则通过接口 "),a("code",[t._v("dataflow.dao.commonDao.getAppUserInfo")]),t._v(" 方法获取。默认的格式如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  global"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用户信息")]),t._v("\n      id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Admin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    auth"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 权限列表，格式参考 Auth Service")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("实际开发过程中，还需要对用户信息和应用权限进行很多判断操作，Vue Admin Next 将其封装成了两个独立的 Service："),a("code",[t._v("UserService")]),t._v(" 及 "),a("code",[t._v("AuthService")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"userservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#userservice"}},[t._v("#")]),t._v(" UserService")]),t._v(" "),a("p",[t._v("在 UserService 中可以根据用户信息提供通用的服务，例如获取名称、ID，判断用户类型等。")]),t._v(" "),a("p",[t._v("详细源码参见 "),a("code",[t._v("src/common/services/UserService.js")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"authservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authservice"}},[t._v("#")]),t._v(" AuthService")]),t._v(" "),a("p",[t._v("在获取到用户的权限列表之后，权限判断的基础服务均由 "),a("code",[t._v("AuthService")]),t._v(" 提供（可基于该 Service 提供权限组件、权限指令等扩展）。")]),t._v(" "),a("p",[t._v("Vue Admin Next 默认基于资源进行鉴权，将每个 URL、链接、按钮等均看成一个资源，分别进行鉴权。虽然这种方式比较灵活，能够满足绝大部分需求，但是配置较为复杂，所以实际项目开发中，你也"),a("strong",[t._v("可以根据需要改为基于其它方式的鉴权")]),t._v("。")]),t._v(" "),a("p",[t._v("应用内路由资源格式参考：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 路由权限，以 / 开头，支持正则表达式")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/form/basic/new/?$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/form/basic/\\\\d+/?$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/table/basic/query/?$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("外部链接（别名）、导航、操作等资源格式参考：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导航外部链接权限")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_alias_github_repo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 代替 https://github.com/openfext/vue-admin-next")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导航菜单权限，AUTH_nav_ 为前缀标识")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_nav_dashboard'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_nav_example'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_nav_example_basic'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_nav_example_auth'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 操作权限（如按钮等），AUTH_action_ 为前缀标识")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_action_example_publish'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AUTH_action_example_offline'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("AuthService 根据以上几种不同的资源格式，分别提供了 "),a("code",[t._v("hasURIAuth")]),t._v("，"),a("code",[t._v("hasAliasAuth")]),t._v("，"),a("code",[t._v("hasNavAuth")]),t._v("，"),a("code",[t._v("hasActionAuth")]),t._v(" 等方法，你可根据实际情况进行扩展。")]),t._v(" "),a("p",[t._v("详细源码参见 "),a("code",[t._v("src/common/services/AuthService.js")]),t._v("。")]),t._v(" "),a("p",[t._v("实际使用场景参考："),a("RouterLink",{attrs:{to:"/zh/vue-admin-next/guide/navigation.html#导航权限判断"}},[t._v("导航权限判断")]),t._v("、"),a("RouterLink",{attrs:{to:"/zh/vue-admin-next/guide/router.html#内置拦截器"}},[t._v("路由拦截器")]),t._v("、"),a("RouterLink",{attrs:{to:"/zh/vue-admin-next/guide/practice.html#操作权限判断"}},[t._v("操作权限判断")]),t._v("。")],1)])}),[],!1,null,null,null);s.default=e.exports}}]);